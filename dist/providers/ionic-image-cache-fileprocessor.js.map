{"version":3,"file":"ionic-image-cache-fileprocessor.js","sourceRoot":"","sources":["../../src/providers/ionic-image-cache-fileprocessor.ts"],"names":[],"mappings":"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","sourcesContent":["import { Platform, Events } from 'ionic-angular';\nimport { Injectable, NgZone } from '@angular/core';\nimport { FileTransfer, FileTransferObject } from '@ionic-native/file-transfer';\nimport { File, FileEntry, RemoveResult, DirectoryEntry } from '@ionic-native/file';\n\n\n@Injectable()\nexport class IonicImageCacheHelperProvider {\n\n  constructor(public event: Events,\n    private transfer: FileTransfer,\n    private file: File,\n    public ngZone: NgZone\n  ) {\n\n  }\n\n  randomIntFromInterval(min, max) {\n    return Math.floor(Math.random() * (max - min + 1) + min);\n  }\n\n  createDir(localFolderPath: string, platform: Platform): Promise<DirectoryEntry> {\n    return new Promise(resolver => {\n      let targetPath: string = \"\";\n      if (platform.is('ios')) {\n        targetPath = this.file.documentsDirectory;\n      }\n      else if (platform.is('android')) {\n        targetPath = this.file.externalDataDirectory;\n      }\n      this.file.createDir(targetPath, localFolderPath, false).then((directory: DirectoryEntry) => {\n        resolver(directory);\n      }).catch(err => {\n        resolver(null);\n        console.log(\"Create directory fail\", err);\n      })\n    })\n  }\n  checkDir(localFolderPath: string, platform: Platform): Promise<boolean> {\n    return new Promise(resolver => {\n      let targetPath: string = \"\";\n      if (platform.is('ios')) {\n        targetPath = this.file.documentsDirectory;\n      }\n      else if (platform.is('android')) {\n        targetPath = this.file.externalDataDirectory;\n      }\n      this.file.checkDir(targetPath, localFolderPath).then((yesNo: boolean) => {\n        resolver(yesNo);\n      }).catch(err => {\n        resolver(false);\n        console.log(\"Check directory\", err);\n        this.createDir(localFolderPath, platform);\n      })\n    })\n  }\n\n  resolveDirectoryUrl(localFolderPath: string, platform: Platform): Promise<DirectoryEntry> {\n    return new Promise(resolver => {\n      let targetPath: string = \"\";\n      if (platform.is('ios')) {\n        targetPath = this.file.documentsDirectory + localFolderPath;\n      }\n      else if (platform.is('android')) {\n        targetPath = this.file.externalDataDirectory + localFolderPath;\n      }\n\n      // console.log(targetPath);\n      this.file.resolveDirectoryUrl(targetPath).then((dEntry: DirectoryEntry) => {\n        resolver(dEntry);\n      }).catch(err => {\n        resolver(null);\n        console.log(\"resolveDirectoryUrl\", err);\n        this.createDir(localFolderPath, platform);\n      })\n    })\n  }\n\n  clearAllCache(localFolderPath: string, platform: Platform) {\n    return new Promise(resolver => {\n      let targetPath: string = \"\";\n      if (platform.is('ios')) {\n        targetPath = this.file.documentsDirectory;\n      }\n      else if (platform.is('android')) {\n        targetPath = this.file.externalDataDirectory;\n      }\n      this.file.removeRecursively(targetPath, localFolderPath).then((removeResult: RemoveResult) => {\n        resolver(removeResult);\n      }).catch(err => {\n        console.log(\"Clear directory\", err);\n      })\n    })\n\n  }\n\n  getFilesInFolder(localFolderPath: string, platform: Platform) {\n    return new Promise(resolver => {\n      let targetPath: string = \"\";\n      if (platform.is('ios')) {\n        targetPath = this.file.documentsDirectory;\n      }\n      else if (platform.is('android')) {\n        targetPath = this.file.externalDataDirectory;\n      }\n      this.file.listDir(targetPath, localFolderPath).then((entry: Array<FileEntry>) => {\n        resolver(entry);\n      }).catch(err => {\n        console.log(\"Get all files in folder \", err);\n      })\n    })\n\n  }\n\n  checkFile(localFolderPath: string, platform: Platform, filename: string) {\n    return new Promise(resolver => {\n      let targetPath: string = \"\";\n      if (platform.is('ios')) {\n        targetPath = this.file.documentsDirectory + localFolderPath;\n      }\n      else if (platform.is('android')) {\n        targetPath = this.file.externalDataDirectory + localFolderPath;\n      }\n      this.file.checkFile(targetPath, filename).then((result: boolean) => {\n        // console.log(\"File exists\");\n        resolver({ yesNo: result, fileURL: targetPath + \"/\" + filename });\n      }).catch(err => {\n        resolver({ yesNo: false, fileURL: targetPath + \"/\" + filename });\n        console.log(\"Get if file is availbale \", err);\n      })\n    })\n\n  }\n\n  getFile(DEntry: DirectoryEntry, fileName: string): Promise<FileEntry> {\n    return new Promise(resolver => {\n      this.file.getFile(DEntry, fileName, { create: false }).then((entry: FileEntry) => {\n        // console.log(\"File exists\");\n        resolver(entry);\n      }).catch(err => {\n        resolver(null);\n        console.log(\"Get file failed \", fileName, err);\n      })\n    })\n\n  }\n\n  extractPath(remoteURL: string, asFilename: boolean = true) {\n    let path: string = (new URL(remoteURL)).pathname\n    if (asFilename) {\n      path = this.replace(\"/\", \"\", path);\n      path = this.replace(\" \", \"\", path);\n    }\n    // console.log(path);\n    return path;\n  }\n\n  ValidURL(str: string): boolean {\n    let result: boolean = str == undefined ? false : ((str.indexOf(\"http://\") > -1 || str.indexOf(\"https://\") > -1) && str.indexOf(\"data:image/\") < 0);\n    // console.log(result, str);\n    return result;\n  }\n\n  downloadImage(fileurl: string, platform: Platform, localFolderPath: string = \"cache_assets\", trustAll: boolean = true) {\n    return new Promise((resolver, reject) => {\n      const fileTransfer: FileTransferObject = this.transfer.create();\n\n      let ext = this.getFileExtentions(fileurl);\n      let prog: number = 0;\n      let targetPath: string = \"\";\n\n      let fpath = this.extractPath(fileurl) + \".\" + ext;\n      \n      if (platform.is('ios')) {\n        // console.log(\"saving to IOS\");\n        targetPath = this.file.documentsDirectory + localFolderPath + \"/\" + fpath;\n      }\n      else if (platform.is('android')) {\n        targetPath = this.file.externalDataDirectory + localFolderPath + \"/\" + fpath;\n      }\n\n      fileTransfer.download(fileurl, targetPath, trustAll).then((entry: FileEntry) => {\n        resolver(entry);\n      }, (error) => {\n        // handle error\n        console.log(error);\n        reject(error);\n      })\n      fileTransfer.onProgress((listener) => {\n        this.ngZone.run(() => {\n          let tempprog = Math.round(((listener.loaded / listener.total) * 100));\n          if (tempprog > prog) {\n\n            this.event.publish('ionicImageCacheprogressCounter', tempprog);\n            prog = tempprog;\n          }\n\n        })\n\n      })\n    });\n  }\n\n  addHours(date: Date, hours: number): Date {\n    date.setHours(date.getHours() + hours);\n    return date;\n  }\n\n  addMinutes(date: Date, minutes: number): Date {\n    date.setMinutes(date.getMinutes() + minutes);\n    return date;\n  }\n\n  safeiOSNativeURL(url: string): string {\n    let finalURL = url.replace(/^file:\\/\\//, '');\n    return finalURL;\n  }\n\n  escapeRegExp(str) {\n    return str.replace(/([.*+?^=!:${}()|\\[\\]\\/\\\\])/g, \"\\\\$1\");\n  }\n  replace(find, replace, fullstr) {\n    return fullstr.replace(new RegExp(this.escapeRegExp(find), 'g'), replace);\n  }\n\n  getFilename(url, withExt: boolean = true): string {\n    let fileName: string = url.substring(url.lastIndexOf('/') + 1);\n    let ext = \".\" + this.getFileExtentions(url);\n    return withExt ? fileName : `${fileName.replace(ext, \"\")}`;\n  }\n\n  getFileExtentions(url): string {\n    return this.getValidExtension(url.split('.').pop());\n  }\n\n  getValidExtension(ext) {\n    const validExtensions = ['png', 'jpg', 'jpeg'];\n    return validExtensions.indexOf(ext) > -1 ? ext : 'jpg';\n  }\n}\n"]}